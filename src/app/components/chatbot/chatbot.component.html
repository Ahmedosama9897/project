<!-- ÿ≤ÿ±ÿßÿ± ŸÅÿ™ÿ≠ ÿßŸÑÿ¥ÿßÿ™ -->
<button class="chat-button" (click)="toggleChat()">üí¨</button>

<!-- ÿµŸÜÿØŸàŸÇ ÿßŸÑÿ¥ÿßÿ™ -->
<div class="chat-box" [class.open]="isOpen">
    <div class="chat-header">
        ChatBot ü¶æ
        <button class="clear-btn" (click)="clearChat()">üóëÔ∏è</button>
    </div>

    <div class="chat-messages" #messageContainer>
        <div [innerHTML]="renderMessages()"></div>
        <!-- ŸÖŸÜÿ™ÿ¨ÿßÿ™ ŸÖŸàÿµŸâ ÿ®Ÿáÿß -->
        <div *ngIf="recommendedItems.length > 0" class="recommended-scroll-wrapper">
            <button class="scroll-btn left" (click)="scrollLeft()">‚Üê</button>

            <div class="recommended-scroll" #scrollContainer>
                <div class="product-card" *ngFor="let item of recommendedItems" (click)="openPopup(item)">
                    <!-- <div *ngIf="item.Discount" class="discount-badge">-{{ item.Discount }}%</div> -->
                    <img [src]="'https://sm-ecommerce.runasp.net/' + item.Image_Cover" alt="{{ item.Item_Name }}"
                        class="product-image" />
                    <div class="product-details">
                        <h4>{{ item.Item_Name }}</h4>
                        <p>{{ item.Description.split(' ', 2).join(' ') }}</p>
                        <div class="price-discount">
                            <span class="price">${{ item.Price_out }}</span>
                        </div>
                        <div class="sold-rate">
                            <span>üî• {{ item.Sold_Count }} sold</span>
                            <span class="stars">‚≠ê {{ item.Rate }}</span>
                        </div>
                    </div>
                </div>
            </div>

            <button class="scroll-btn right" (click)="scrollRight()">‚Üí</button>
        </div>

        <!-- Popup ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑŸÖŸÜÿ™ÿ¨ -->
        <div *ngIf="selectedProduct" class="product-popup-backdrop" (click)="closePopup()">
            <div class="product-popup" (click)="$event.stopPropagation()">
                <h3>{{ selectedProduct.Item_Name }}</h3>
                <p style="font-weight: bold;">{{ selectedProduct.Description }}</p>

                <img [src]="'https://sm-ecommerce.runasp.net/' + selectedProduct.Image_Cover"
                    alt="{{ selectedProduct.Item_Name }}" style="width: 100%; border-radius: 8px; margin: 12px 0;" />
                <p>{{ selectedProduct.Description }}</p>
                <p><strong>Price:</strong> ${{ selectedProduct.Price_out }}</p>
                <p><strong>Sold:</strong> {{ selectedProduct.Sold_Count }}</p>
                <p><strong>Rate:</strong> ‚≠ê {{ selectedProduct.Rate }}</p>
                <button (click)="closePopup()"
                    style="margin-top: 12px; padding: 8px 16px; background-color: #dc3545; color: white; border: none; border-radius: 6px; cursor: pointer;">
                    Close
                </button>
            </div>
        </div>




        <div class="typing-dots" [class.show]="isTyping">
            <span>.</span><span>.</span><span>.</span>
        </div>
    </div>

    <div class="chat-input">
        <input [value]="newMessage" (input)="onInputChange($event)" placeholder="Send message..." />
        <button (click)="sendMessage()">Send</button>
    </div>



</div>